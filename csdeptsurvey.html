<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CS Department Survey</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body {
            background-color: #f0f0f0; /* Light gray background */
            font-family: 'Arial', sans-serif;
        }

        h1 {
            color: #006633; /* GMU Green */
        }

        .header-box {
            border: 5px solid #006633; /* GMU Green border */
            padding: 20px;
            margin-bottom: 30px;
            background-color: #fff;
            box-shadow: 5px 5px 15px rgba(0, 0, 0, 0.2);
        }

        label {
            font-weight: bold;
        }

        input, select, textarea {
            background-color: #fff;
            padding: 10px;
            border: 2px solid #006633; /* GMU Green border */
            transition: 0.3s ease-in-out;
        }

        input:focus, select:focus, textarea:focus {
            border-color: #FFCC33; /* GMU Yellow border on focus */
            box-shadow: 0 0 8px rgba(255, 204, 51, 0.4);
        }

        .home-button {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: #FFCC33; /* GMU Green */
            color: #006633;
            padding: 10px 20px;
            border-radius: 25px;
            text-decoration: none;
        }

        .home-button:hover {
            background-color: #004d26;
        }

        .btn-custom {
            background-color: #006633; /* GMU Green */
            color: white;
            border: none;
            transition: transform 0.3s ease;
        }

        .btn-custom:hover {
            background-color: #004d26;
            transform: scale(1.05);
        }

        .form-group {
            margin-bottom: 1.5rem;
        }
    </style>
</head>

<body>
<!-- Navigation Bar -->
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <a class="navbar-brand" href="#">Akshitha Kolanupaka</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
            <li class="nav-item active">
                <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
            </li>
            
            <li class="nav-item">
                <a class="nav-link" href="csdeptsurvey.html">CS Department</a>
            </li>
        </ul>
    </div>
</nav>
    <div class="container">
        <!-- Home Button Top Right -->
        <!-- <a href="index.html" class="home-button">Home</a> -->

        <!-- Header Section -->
        <div class="header-box text-center">
            <h1>Computer Science Department Survey</h1>
            <p class="lead">We value your feedback! Please fill out the survey below.</p>
            <div id="greeting"></div>
        </div>

        <!-- Survey Form -->
        <form id="surveyForm" action="/submit-survey" method="POST" autocomplete="on" class="mb-5">
            <!-- First Name -->
            <div class="form-group">
                <label for="firstName">First Name</label>
                <input type="text" id="firstName" name="firstName" class="form-control" required>
            </div>

            <!-- Last Name -->
            <div class="form-group">
                <label for="lastName">Last Name</label>
                <input type="text" id="lastName" name="lastName" class="form-control" required>
            </div>

            <!-- Street Address -->
            <div class="form-group">
                <label for="streetAddress">Street Address</label>
                <input type="text" id="streetAddress" name="streetAddress" class="form-control" required>
            </div>
            <!-- Zip Code -->
            <div class="form-group">
                <label for="zip">Zip Code</label>
                <input type="text" id="zip" name="zip" class="form-control" required>
            </div>

            <!-- City -->
            <div class="form-group">
                <label for="city">City</label>
                <input type="text" id="city" name="city" class="form-control" required>
            </div>

            <!-- State -->
            <div class="form-group">
                <label for="state">State</label>
                <input type="text" id="state" name="state" class="form-control" required>
            </div>

            

            <!-- Telephone Number -->
            <div class="form-group">
                <label for="telephone">Telephone Number</label>
                <input type="tel" id="telephone" name="telephone" class="form-control" required>
            </div>

            <!-- Email -->
            <div class="form-group">
                <label for="email">Email</label>
                <input type="email" id="email" name="email" class="form-control" required>
            </div>

            <!-- Survey Date -->
            <div class="form-group">
                <label for="surveyDate">Survey Date</label>
                <input type="date" id="surveyDate" name="surveyDate" class="form-control" required>
            </div>

            <!-- What Did You Like Most About the Campus -->
            <div class="form-group">
                <label>What did you like most about the campus? (Select all that apply)</label><br>
                <div class="form-check">
                    <input type="checkbox" name="campusLikes" value="students" class="form-check-input" id="likeStudents">
                    <label class="form-check-label" for="likeStudents">Students</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="campusLikes" value="location" class="form-check-input" id="likeLocation">
                    <label class="form-check-label" for="likeLocation">Location</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="campusLikes" value="campus" class="form-check-input" id="likeCampus">
                    <label class="form-check-label" for="likeCampus">Campus</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="campusLikes" value="atmosphere" class="form-check-input" id="likeAtmosphere">
                    <label class="form-check-label" for="likeAtmosphere">Atmosphere</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="campusLikes" value="dormRooms" class="form-check-input" id="likeDormRooms">
                    <label class="form-check-label" for="likeDormRooms">Dorm Rooms</label>
                </div>
                <div class="form-check">
                    <input type="checkbox" name="campusLikes" value="sports" class="form-check-input" id="likeSports">
                    <label class="form-check-label" for="likeSports">Sports</label>
                </div>
            </div>

            <!-- How Did You Become Interested in the University -->
            <div class="form-group">
                <label>How did you become interested in the university?</label><br>
                <div class="form-check">
                    <input type="radio" name="interestSource" value="friends" class="form-check-input" id="sourceFriends">
                    <label class="form-check-label" for="sourceFriends">Friends</label>
                </div>
                <div class="form-check">
                    <input type="radio" name="interestSource" value="television" class="form-check-input" id="sourceTelevision">
                    <label class="form-check-label" for="sourceTelevision">Television</label>
                </div>
                <div class="form-check">
                    <input type="radio" name="interestSource" value="internet" class="form-check-input" id="sourceInternet">
                    <label class="form-check-label" for="sourceInternet">Internet</label>
                </div>
                <div class="form-check">
                    <input type="radio" name="interestSource" value="other" class="form-check-input" id="sourceOther">
                    <label class="form-check-label" for="sourceOther">Other</label>
                </div>
            </div>

            <!-- Likelihood of Recommending the School -->
            <div class="form-group">
                <label for="recommendation">How likely are you to recommend this school?</label>
                <select id="recommendation" name="recommendation" class="form-control">
                    <option value="very-likely">Very Likely</option>
                    <option value="likely">Likely</option>
                    <option value="unlikely">Unlikely</option>
                </select>
            </div>

            <!-- Raffle -->
            <div class="form-group">
                <label for="raffle">Enter Raffle Numbers (1-100, comma separated)</label>
                <input type="text" id="raffle" name="raffle" class="form-control">
            </div>

            <!-- Data Field -->
            <div class="form-group">
                <label for="data">Data (Enter 10 comma separated numbers between 1 and 100)</label>
                <input type="text" id="data" name="data" class="form-control" required onblur="computeAverageAndMaximum()">
                <small id="dataError" class="form-text text-danger"></small>
            </div>

            <!-- Average and Maximum Output Fields -->
            <div class="form-group">
                <label for="average">Average</label>
                <input type="text" id="average" name="average" class="form-control" readonly>
            </div>

            <div class="form-group">
                <label for="maximum">Maximum</label>
                <input type="text" id="maximum" name="maximum" class="form-control" readonly>
            </div>

            <!-- Additional Comments -->
            <div class="form-group">
                <label for="comments">Additional Comments</label>
                <textarea id="comments" name="comments" class="form-control" rows="4"></textarea>
            </div>

            <!-- Submit and Cancel Buttons -->
            <button type="submit" class="btn btn-custom">Submit</button>
            <button type="reset" class="btn btn-light">Cancel</button>
        </form>
    </div>

    <script>
        function setCookie(name, value, days) {
            const d = new Date();
            d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
            const expires = "expires=" + d.toUTCString();
            document.cookie = name + "=" + value + ";" + expires + ";path=/";
        }

        function getCookie(name) {
            const cname = name + "=";
            const decodedCookie = decodeURIComponent(document.cookie);
            const ca = decodedCookie.split(';');
            for (let i = 0; i < ca.length; i++) {
                let c = ca[i];
                while (c.charAt(0) === ' ') {
                    c = c.substring(1);
                }
                if (c.indexOf(cname) === 0) {
                    return c.substring(cname.length, c.length);
                }
            }
            return "";
        }

        function checkCookie() {
            let user = getCookie("username");
            if (user !== "") {
                displayGreeting(user);
            } else {
                user = prompt("Please enter your name:", "");
                if (user !== "" && user !== null) {
                    setCookie("username", user, 365);
                    displayGreeting(user);
                }
            }
        }

        function displayGreeting(name) {
            const now = new Date();
            const hours = now.getHours();
            let greeting;

            if (hours < 12) {
                greeting = "Good Morning";
            } else if (hours < 18) {
                greeting = "Good Afternoon";
            } else {
                greeting = "Good Evening";
            }

            document.getElementById("greeting").innerHTML = `${greeting} ${name}, welcome to SWE642 Survey`;
        }

        function computeAverageAndMaximum() {
            const dataField = document.getElementById("data");
            const dataError = document.getElementById("dataError");
            const averageField = document.getElementById("average");
            const maximumField = document.getElementById("maximum");

            const data = dataField.value.split(',').map(Number);
            if (data.length !== 10 || data.some(num => isNaN(num) || num < 1 || num > 100)) {
                dataError.textContent = "Please enter exactly 10 comma separated numbers between 1 and 100.";
                averageField.value = "";
                maximumField.value = "";
                return;
            }

            dataError.textContent = "";
            const sum = data.reduce((acc, num) => acc + num, 0);
            const average = sum / data.length;
            const maximum = Math.max(...data);

            averageField.value = average.toFixed(2);
            maximumField.value = maximum;
        }

        function validateForm(event) {
            const form = document.getElementById('surveyForm');
            const firstName = form.firstName.value;
            const lastName = form.lastName.value;
            const streetAddress = form.streetAddress.value;
            const city = form.city.value;
            const state = form.state.value;
            const email = form.email.value;
            const checkboxes = form.querySelectorAll('input[name="campusLikes"]:checked');
            const radioButtons = form.querySelectorAll('input[name="interestSource"]:checked');
            const emailPattern = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;

            let errorMessage = "";
            let hasError = false;

            // Validate Name fields
            if (!/^[A-Za-z]+$/.test(firstName)) {
                errorMessage += "First Name should contain only alphabets.\n";
                form.firstName.value = "";
                hasError = true;
            }
            if (!/^[A-Za-z]+$/.test(lastName)) {
                errorMessage += "Last Name should contain only alphabets.\n";
                form.lastName.value = "";
                hasError = true;
            }

            // Validate Address fields
            if (!/^[A-Za-z0-9\s,.'-]{3,}$/.test(streetAddress)) {
                errorMessage += "Street Address should contain appropriate characters.\n";
                form.streetAddress.value = "";
                hasError = true;
            }
            if (!/^[A-Za-z\s,.'-]{2,}$/.test(city)) {
                errorMessage += "City should contain appropriate characters.\n";
                form.city.value = "";
                hasError = true;
            }
            if (!/^[A-Za-z\s,.'-]{2,}$/.test(state)) {
                errorMessage += "State should contain appropriate characters.\n";
                form.state.value = "";
                hasError = true;
            }

            // Validate Email
            if (!emailPattern.test(email)) {
                errorMessage += "Please enter a valid email address.\n";
                form.email.value = "";
                hasError = true;
            }

            // Validate Checkboxes
            if (checkboxes.length < 2) {
                errorMessage += 'Please select at least two options for "What did you like most about the campus?".\n';
                hasError = true;
            }

            // Validate Radio Buttons
            if (radioButtons.length === 0) {
                errorMessage += 'Please select an option for "How did you become interested in the university?".\n';
                hasError = true;
            }

            if (hasError) {
                alert(errorMessage);
                event.preventDefault();
            }
        }

        document.getElementById('surveyForm').addEventListener('submit', validateForm);
        checkCookie();

        document.getElementById('zip').addEventListener('blur', function() {
            const zip = this.value;
            if (zip) {
                fetch('zipcodes.json')
                    .then(response => response.json())
                    .then(data => {
                        if (Array.isArray(data["zipcodes"])) {
                            const zipcodeData = data["zipcodes"].find(item => item.zip === zip);
                            if (zipcodeData) {
                                document.getElementById('city').value = zipcodeData.city;
                                document.getElementById('state').value = zipcodeData.state;
                                document.getElementById('zip').setCustomValidity('');
                            } else {
                                document.getElementById('city').value = '';
                                document.getElementById('state').value = '';
                                document.getElementById('zip').setCustomValidity('Invalid zip code');
                            }
                        } else {
                            console.error('Error: Expected an array of zip codes');
                        }
                    })
                    .catch(error => console.error('Error fetching the zip codes:', error));
            }
        });
    </script>
</body>

</html>

   